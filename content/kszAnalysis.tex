\label{sec:kszAnalysis}
To understand which $\bm{k}$ of $\delta$ are most necessary in reconstructing the kSZ signal, the first step is to clarify which angular scale of the kSZ we are interested in. 
As demonstrated in Fig.\ref{fig:cmb_21cm}, the kSZ effect is too faint to be distinguished until the primary CMB starts to fade away, at roughly $\ell>500$. 
It is possible to select a frequency band where the thermal SZ signal is negligible, then the dominant factor at high $\ell$ will be the CMB instrumental noise.  With existing Planck \cite{Planck2015} data at 217 GHz, $\ell \sim 500-3000$ will be the visible window for kSZ signal to be distinguished with sufficient S/N over primary CMB and facility noise. The way to estimate S/N is presented in Section.\ref{sec:sn}. The window could be extended to higher frequency with ACTpol and CMB-S4. 

The next step is to understand what role each scale plays in contributing to the kSZ signal at $\ell \sim 500-3000$. If we write Eq.(\ref{eq:ksz}) in Fourier space, and given that $g(\eta)$ varies slowly, we see that $\Theta(\bm{\ell})$ is propotional to the $k_z=0$ mode of the momentum field, as marked in Fig.\ref{fig:p},
%$p_\parallel(\bm{k})$. 
\begin{align}
    \label{eq:thetak}
    \Theta(\bm{\ell}) &\propto p_\parallel({k}_x\chi,{k}_y\chi,0)\\
     & \propto \int 
    d^3k^\prime\,\delta(\bm{\ell}/\chi-\bm{k}_\perp^\prime,k_\parallel^\prime) v_z(\bm{k_\perp^\prime},k_\parallel^\prime)\nonumber.
    \end{align}
The convolution of $\delta$ and $v_z$ tells us that the signal comes from the cross talk of $\bm{\ell}/\chi-\bm{k}_\perp^\prime$ and $\bm{k}_\perp$, with a sum over all $k^\prime$. 

Although the summation is over all $k^\prime$, not all the modes 
make conceivable contributions to final signal $\Theta(\bm{\ell})$.
The effective modes on velocity and density fields for 
generating kSZ signals should satisfy two requirements: 
1. Since the two fields are fully coupled together, 
only when $|\delta|$ and its coupling partner $|v_z|$ are both sufficiently large can they make noticeable contribution to $\theta(\bm{\ell})$; 
2. The convolution in Eq (\ref{eq:thetak}) indicates that  
not $v_z(\bm{k})$ and $\delta(\bm{k})$ with identical $\bm{k}$, 
but those  
with identical $k_z$ but a seperation of $\delta \bm{k_\perp}= \ell/\chi$ in 
$k_\perp$ plane can be coupled together. 
Therefore, the effective modes for $v_z$ and $\delta$ come as a pair with $\ell$ seperation in $k$ space. 

Having these two factors in mind, 
we look at the relative strength of 
different modes in $v_z$ and $\delta$ in Fig.\ref{Fig:k3v}. 
The modes circled by red lines in upper and lower panels are coupled together, 
and both components in a pair have enough power. 
These are the effective modes for generating kSZ signals. 

Another way to look at this is to 
boldly approximate $v_z$ as a Dirac delta function $\delta^D(\bm{k}^\prime)$,  
since $v_z \propto k_z/k^3$, its power drops fast as k grows.  
Then $\Theta(\bm{\ell})$ will reduce to $\delta(\bm{\ell}/\chi,0) v_z(0,0)$, with integration over the other $k^\prime$ being negligible due to the faintness of $v_z(k^\prime\neq0)$. In reality, where $v_z(\bm{k})$ is not as sharp as a Dirac delta, the peak will be closer to ($k_\perp$,$k_\parallel$)=($0.01$,$0.1$) h/Mpc rather than (0,0). We then see  
that most of the kSZ signal is generated by the cross talk between the part of $v_z(\bm{k})$ with $k$ in a small ball surrounding (0.01,0.1) h/Mpc and the part of $\delta(k)$ with $k$ close to $\delta(\bm{\ell}/\chi,0.1)$ h/Mpc. 
This is identical to previous estimates. 
%This is demonstrated in Fig.\ref{fig:k3v}.
%Background color indicates the contribution of $|\delta(k)|$ and $|v_z(k)|$ 
%during Fourier transform. 
Comparing the effective modes for generating kSZ signals with 
modes resolved in 21cm IM in Fig.\ref{fig:cmb_21cm}, 
we notice that while the effective modes for $\delta$ are partly resolved, the large scale information dominating $v_z$ is almost completely filtered out of the 21 cm IM field. Therefore, to retrieve the cross-correlation between kSZ and 21cm IM fields we must first reconstruct the large-scale $v_z$ modes.
